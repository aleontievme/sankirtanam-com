<div id="container" height="450"></div>

<table class="table table-condensed table-bordered">
  <tr>
    <th>Локация</th>
    <th>ЯНВ</th>
    <th>ФЕВ</th>
    <th>МАР</th>
    <th>АПР</th>
    <th>МАЙ</th>
    <th>ИЮН</th>
    <th>ИЮЛ</th>
    <th>АВГ</th>
    <th>СЕН</th>
    <th>ОКТ</th>
    <th>НОЯ</th>
    <th>ДЕК</th>
    <th>ИТОГ</th>
  </tr>

  <% for location in @locations %>
    <tr>
      <td><%=location.name%></td>
      <% for i in 0..11 %>
        <% if @city_month_stat[location] == nil then %>
          <td></td>
        <% else %>
          <td><%= @city_month_stat[location][i] %></td>
        <% end %>
      <% end %>
      
      <% if @city_month_stat[location] != nil then %>
        <td><%=@city_month_stat[location][-1]%></td>
      <% else %>
        <td></td>
      <% end %>
    <tr>
  <% end %>
</table>


<script type="text/javascript">
$(function () {
  <% charts = chart() %>
  $('#container').highcharts({
    chart: { type: 'column' },
    title: { text: 'Статистика по городам за <%=@year%> год' },
    xAxis: {
      type: 'category',
      labels: {
        rotation: -45,
        align: 'right',
        style: {
          fontSize: '10px',
          fontFamily: 'Verdana, sans-serif'
        }
      }
    },
    yAxis: { min: 0, title: { text: 'Очки' } },
    legend: { enabled: false },
    series: [{
      name: 'Очки',
      data: [
        <% charts.each do |key, value| %>
          {name:'<%=key%>', y:<%=value%>},
        <% end %>
      ]
    }]
  });
});
</script


<%= render partial: "report/form", :locals => {locations: @locations} %>
